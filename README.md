## SFFS

* 容量：4 GB
* 块大小：4 KB
* 文件夹：不支持
* 最多文件数：1024
* 以上参数均可通过修改头文件比较方便地修改。

## 功能

- 创建
- 读
- 写
- 截断
- 删除
- 维护文件元数据
- 维护文件系统元数据
- 查看文件系统使用情况（使用 `df` 命令）

## 源文件说明

* sffs_def.h

  文件系统大小、块大小等常量的定义；

  超级块、属性块、链块、数据块的定义等。

* sffs_blocks.c

  分配内存块、释放内存块、分配块、释放块、操作 bitmap 等的实现。

* sffs.c

  与 fuse 对接的各函数的实现。

- block 0

  文件系统元信息：

  - 块数；
  - 已占用块数。

- bitmap blocks

  各个块是否占用，每个 bit 对应一个 block。

- index blocks

  文件首块的列表，每个 unsigned long long 对应一个文件属性块（attr block）。

- attr blocks

  文件的元数据，包括：

  - 文件名（最长为 255 个字符）；
  - 最后一次修改时间；
  - 最后一次访问时间；
  - 用户 id；
  - 组 id；
  - 大小。

- chain blocks

  链块，链块之间形成链表的结构，每个链块中保存一组块号，每个块号是该文件的数据块的编号，按块的顺序存储。

- data blocks

  文件的数据。

## 注

未实现目录功能，但是可以比较容易地扩展——在文件元数据中增加一个“文件类型”域，将目录作为一种特殊的文件类型即可。还可以通过这种方式增加链接功能，但是需要再将文件内容与文件元数据独立起来，体力活，没有做。
